@model List<GreenAgriApp.Models.Resource>
@{
    ViewData["Title"] = "Educational Resources";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/css/agriconnect-form.css" />
</head>
<body>

<section class="form-hero-section">
    <h1>Educational Resources</h1>
    <p>Browse, view and manage uploaded learning materials.</p>
</section>

<div style="text-align: center; margin-top: 30px;">
    <a href="@Url.Action("UploadResource", "Employee")" class="submit-button" style="max-width: 250px; margin-bottom: 20px; display: inline-block;">
        <i class="fas fa-plus-circle"></i> Add Resource
    </a>
</div>

<div class="category-search-wrapper">
    <input type="text" id="searchBox" placeholder="🔍 Search by title or description..." onkeyup="filterResources()" class="fancy-search-box" />
</div>

<div class="table-wrapper">
    <table class="styled-table" id="resourceTable">
        <thead>
            <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Upload Date</th>
                <th>Download</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var res in Model)
        {
            <tr onclick="location.href='@Url.Action("ViewResource", "Employee", new { id = res.Id })'" style="cursor:pointer;">
                <td>@res.Title</td>
                <td>@res.Description</td>
                <td>@res.UploadDate.ToShortDateString()</td>
                <td>
                    <a href="@res.FilePath" download class="submit-button" style="padding: 6px 12px; font-size: 0.9rem;">
                        <i class="fas fa-download"></i> Download
                    </a>
                </td>
            </tr>
        }
        </tbody>
    </table>
</div>

@section Scripts {
<script>
    function filterResources() {
        const input = document.getElementById('searchBox').value.toLowerCase();
        const table = document.getElementById('resourceTable');
        const rows = table.getElementsByTagName('tr');

        for (let i = 1; i < rows.length; i++) {
            const title = rows[i].cells[0].innerText.toLowerCase();
            const desc = rows[i].cells[1].innerText.toLowerCase();
            const match = title.includes(input) || desc.includes(input);
            rows[i].style.display = match ? '' : 'none';
        }
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        @if (TempData["Success"] != null)
        {
            <text>
                Swal.fire({
                    toast: true,
                    position: 'top-end',
                    icon: 'success',
                    title: @Html.Raw(Json.Serialize(TempData["Success"])),
                    showConfirmButton: false,
                    timer: 5500,
                    timerProgressBar: true,
                    background: '#004d29',
                    color: 'white',
                    iconColor: '#21a95d'
                });
            </text>
        }
    });
</script>
}

</body>
</html>
